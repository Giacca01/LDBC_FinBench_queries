// Query preparatoria, che recupera tutti gli utenti che investono in aziende
// in modo che dall'applicazione sia possibile scegliere
// quelli tra cui calcolare la similarità
MATCH (p:Person)-[:PersonInvest]->(:Company) RETURN p


// Calcolo intersezione tra insiemi di aziende in cui investono entrambi
// gli utenti considerati
MATCH (p1:Person)-[:PersonInvest]->(c1:Company)<-[:PersonInvest]-(p2:Person) 
WHERE p1._id = 4398046511104 and p2._id = 26388279066625 
RETURN c1._id

// Calcolo insiemi società dei singoli utenti, per poter misurare
// la cardinalità dell'Unione
MATCH (p1:Person)-[:PersonInvest]->(c1:Company) 
WHERE p1.id = 17592186044622
RETURN c1.name

MATCH (p1:Person)-[:PersonInvest]->(c1:Company) 
WHERE p1.id = 26388279067009
RETURN c1.name


// Voglio trovare tutti gli account lavatrice, cioè quelli che in un certo
// periodo di tempo ricevono e poi trasferiscono denaro da e/o verso
// persone bloccate (interpretiamo il bloccaggio come indice di pericolosità)
MATCH (pSrc:Person)-[:Own]->(src: Account)-[rcv:Transfer]->(mid:Account)-[snd:Transfer]->(dst:Account)<-[:Own]-(pDst:Person)
WHERE rcv.createTime > startWindow and rcv.createTime < endWindow
and snd.createTime > startWindow and snd.createTime < endWindow
and src.isBlocked or mid.isBlocked or snd.isBlocked
RETURN src.nickname, mid.nickname, dst.nickname
